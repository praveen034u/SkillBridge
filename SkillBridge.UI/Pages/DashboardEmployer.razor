@page "/employer-dashboard"
@using System.Text.Json;
@inject IJSRuntime JS

<h3>Posted Jobs</h3>

<table>
    <thead>
        <tr>
            <th>Title</th>
            <th>Company</th>
            <th>Location</th>
            <th>Employment Type</th>
            <th>Posted Date</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var job in postedJobs)
        {
            <tr>
                <td>@job.Title</td>
                <td>@job.CompanyName</td>
                <td>@job.Location</td>
                <td>@job.EmploymentType</td>
                <td>@job.PostedDate.ToShortDateString()</td>
                <td><button class="disable-button">Disable</button></td>
                <td><button class="get-profiles-button" @onclick="() => GetProfiles(job.Id)">Get Profiles</button></td>
            </tr>
        }
    </tbody>
</table>
<br/>
<hr />

@if (showProfiles)
{
    <h3>List of Matching Profiles</h3>
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Years of Experience</th>
                <th>Location</th>
                <th>Matching Score(%)</th>
                <th>Resume</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var profile in matchingProfiles)
            {
                <tr>
                    <td>@profile.Name</td>
                    <td>@profile.YearsOfExperience Years</td>
                    <td>@(profile.IsLocalCandidate ? "Local" : "Non-Local")</td>
                    <td> Score: @profile.SkillsScore</td>
                    <td><a href="@profile.ResumeUrl" download>Download Resume</a></td>
                </tr>
            }
        </tbody>
    </table>
}

@code {
    private List<Job> postedJobs = new()
    {
        new Job { Id = "1", Title = "Software Developer", CompanyName = "ABC Inc.", Location = "New York, NY", EmploymentType = "Full-Time", PostedDate = DateTime.Now },
        new Job { Id = "2", Title = "Data Analyst", CompanyName = "XYZ Corp.", Location = "Los Angeles, CA", EmploymentType = "Part-Time", PostedDate = DateTime.Now }
    };

    private bool showProfiles = false;
    private List<Profile> matchingProfiles = new();

    private void GetProfiles(string jobId)
    {
        // Simulate fetching profiles (Replace with API call)
        matchingProfiles = new List<Profile>
        {
            new Profile { Name = "John Doe", YearsOfExperience = 5, IsLocalCandidate = true, SkillsScore = 85, ResumeUrl = "#" },
            new Profile { Name = "Jane Smith", YearsOfExperience = 3, IsLocalCandidate = false, SkillsScore = 78, ResumeUrl = "#" }
        };
        showProfiles = true;
    }

    private class Profile
    {
        public string Name { get; set; }
        public int YearsOfExperience { get; set; }
        public bool IsLocalCandidate { get; set; }
        public int SkillsScore { get; set; }
        public string ResumeUrl { get; set; }
    }
}
